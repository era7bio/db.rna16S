package ohnosequences.db.rna16s.test

import com.amazonaws.auth._
import ohnosequences.awstools.s3._
import ohnosequences.db

/* Copy data in S3 generated by dropInconsistentAssignments filter to a location defined in main/scala/release.scala */
case object releaseData {

  def apply(credentials: AWSCredentialsProvider): Unit = {
    val transferManager = S3Client(credentials = credentials).createTransferManager

    print(s"Copying fasta... ")
    transferManager.copy(
      dropInconsistentAssignments.output.fasta.s3,
      db.rna16s.data.fastaS3
    ).get
    println("Done!")

    print(s"Copying assignments table... ")
    transferManager.copy(
      dropInconsistentAssignments.output.table.s3,
      db.rna16s.data.id2taxasS3
    ).get
    println("Done!")

    print(s"Copying blastdb... ")
    transferManager.copy(
      dropInconsistentAssignmentsAndGenerate.s3destination,
      db.rna16s.data.blastDBS3
    ).get
    println("Done!")

    transferManager.shutdownNow(true)
  }

}
